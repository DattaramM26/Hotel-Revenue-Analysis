-- to check hotel revenue by year now we don't have revenue column so we calculated by using revenue = stays * daily rate
--then we group by arrival date to check year wise total revenue
-- this the query
 
select 
arrival_date_year,hotel,	
round(sum((stays_in_week_nights+stays_in_weekend_nights)*adr),2)  as revenue 
from hotels
group by arrival_date_year,hotel

the first step is to create a new database named project
-- second step to import the data from excel which has tables
--now we use union to collect all the tables together

-- getting these three tables under one name hotels 

with hotels as(     
select * from dbo.['2018$']
union
select * from dbo.['2019$']
union
select * from dbo.['2020$'] 
)
-- to check hotel revenue by year now we don't have revenue column so we calculated by using revenue = stays * daily rate
--then we group by arrival date to check year wise total revenue
-- this the query
 
select 
arrival_date_year,hotel,	
round(sum((stays_in_week_nights+stays_in_weekend_nights)*adr),2)  as revenue 
from hotels
group by arrival_date_year,hotel



--now we need to validate the 2020 table 

select * from hotels
left join dbo.market_segment$ 
on hotels.market_segment=market_segment$.market_segment
left join dbo.meal_cost$ 
on meal_cost$.meal=hotels.meal

